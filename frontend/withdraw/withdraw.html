<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BankApp ‚Äî Withdraw Money</title>

  <style>
    :root{
      --accent:#667eea;
      --muted:#666;
      --bg:#f7f8fc;
      --card:#ffffff;
      --border:#e6e9f2;
      --radius:12px;
      --shadow: 0 6px 20px rgba(102,126,234,0.08);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: light;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:#111}
    a{color:var(--accent);text-decoration:none}
    nav{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;background:transparent}
    .logo-section{display:flex;align-items:center;gap:10px}
    .logo{font-size:26px}
    .logo-text{font-weight:700;color:var(--accent)}
    .nav-links{display:flex;align-items:center;gap:14px;list-style:none;padding:0;margin:0}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;font-weight:600;border:0;cursor:pointer;background:var(--accent);color:#fff;}
    .btn-outline{background:transparent;color:var(--accent);border:2px solid var(--accent)}

    .container{max-width:980px;margin:24px auto;padding:20px;display:grid;grid-template-columns:1fr 560px;gap:28px;align-items:start}
    .panel{background:linear-gradient(180deg,#fff,#fbfdff);border-radius:var(--radius);padding:28px;box-shadow:var(--shadow);border:1px solid var(--border);display:flex;flex-direction:column;gap:16px}
    .panel .logo{font-size:42px}
    .panel h1{margin:0;font-size:20px}
    .panel p{margin:0;color:var(--muted)}

    .card{background:var(--card);border-radius:var(--radius);padding:22px;box-shadow:var(--shadow);border:1px solid var(--border)}
    .section-title{color:var(--accent);margin:0 0 14px;font-size:16px}
    form{display:flex;flex-direction:column;gap:12px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .form-group{display:flex;flex-direction:column;gap:8px}
    label{font-size:13px;color:#222;font-weight:600}
    .input-wrapper{position:relative}
    .input-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);font-size:16px;opacity:0.95}
    input[type="text"], input[type="email"], input[type="tel"], input[type="date"], input[type="number"], input[type="password"], select {
      width:100%;padding:12px 14px 12px 46px;border-radius:10px;border:2px solid var(--border);outline:none;font-size:15px;background:transparent;transition:box-shadow .15s,border-color .15s;
    }
    input:focus, select:focus{border-color:var(--accent);box-shadow:0 6px 18px rgba(102,126,234,0.08)}
    .full-width{grid-column:1/-1}
    .muted{color:var(--muted);font-size:13px}
    .error-message{color:#b00020;background:#fff0f2;padding:10px;border-radius:8px;border:1px solid #f4c2d0;display:none}
    .success-message{color:#0a7d4b;background:#ecf9f1;padding:10px;border-radius:8px;border:1px solid #bde6c8;display:none}
    .actions{display:flex;gap:12px;align-items:center;margin-top:8px}
    .pin-toggle{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:transparent;border:0;font-weight:600;cursor:pointer;color:var(--muted)}
    .small-btn{padding:8px 10px;border-radius:8px;border:1px solid var(--border);background:#fff;cursor:pointer}
    .balance-bubble{background:#f2f6ff;color:var(--accent);padding:8px 12px;border-radius:999px;border:1px solid #e4e9ff;font-weight:600}

    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.38);display:none;align-items:center;justify-content:center;z-index:1200}
    .modal{background:var(--card);border-radius:12px;padding:18px 20px;max-width:420px;width:92%;box-shadow:0 12px 40px rgba(0,0,0,0.18);border:1px solid var(--border)}
    .modal h3{margin:0 0 12px}
    .modal .row{display:flex;justify-content:space-between;margin:8px 0;color:#333}
    .modal .muted{color:var(--muted)}
    .modal-actions{display:flex;gap:10px;margin-top:14px;justify-content:flex-end}
    .btn-ghost{background:transparent;border:1px solid #ddd;color:#333;padding:10px 12px;border-radius:8px;cursor:pointer}

    @media (max-width:980px){.container{grid-template-columns:1fr;padding:12px}}
    @media (max-width:520px){.grid{grid-template-columns:1fr}.logo-text{display:none}}
  </style>
</head>
<body>
  <nav>
    <div class="logo-section"><div class="logo">üè¶</div><div class="logo-text">BankApp</div></div>
    <ul class="nav-links" id="navLinks" aria-label="Primary">
      <li><a href="#home">Home</a></li>
      <li><a href="#features">Features</a></li>
      <li><a href="#about">About</a></li>
      <li><a href="#contact">Contact</a></li>
      <li class="nav-buttons">
        <a href="./loginPage/login.html" class="btn-outline btn" role="button">Login</a>
        <a href="signup.html" class="btn" role="button">Sign Up</a>
      </li>
    </ul>
  </nav>

  <main class="container" aria-labelledby="pageTitle">
    <aside class="panel" aria-hidden="false">
      <div class="logo">üè¶</div>
      <h1 id="pageTitle">Withdraw Money</h1>
      <p class="muted">Quickly withdraw from your account. Confirm details before proceeding.</p>
      <p class="muted">Demo project: balances are simulated. Integrate with your server to fetch real balances.</p>
    </aside>

    <section class="card" aria-label="Withdraw form">
      <div id="notify" class="error-message" role="status" aria-live="polite"></div>
      <div id="notifySuccess" class="success-message" role="status" aria-live="polite"></div>

      <form id="withdrawForm" novalidate>
        <h3 class="section-title">Withdrawal Details</h3>

        <div class="grid">
          <div class="form-group">
            <label for="accountNum">Account Number</label>
            <div class="input-wrapper">
              <span class="input-icon">üèß</span>
              <input type="text" id="accountNum" name="accountNum" placeholder="Enter your account number" inputmode="numeric" required>
            </div>
          </div>

          <div class="form-group">
            <label for="accountType">Account Type</label>
            <div class="input-wrapper">
              <span class="input-icon">üí≥</span>
              <select id="accountType" name="accountType" required>
                <option value="">Select Account Type</option>
                <option value="savings">Savings</option>
                <option value="checking">Checking</option>
                <option value="business">Business</option>
              </select>
            </div>
          </div>

          <div class="form-group full-width">
            <label>Available Balance</label>
            <div style="display:flex;gap:8px;align-items:center">
              <div id="balanceBubble" class="balance-bubble">‚Äî</div>
              <button type="button" id="fetchBalanceBtn" class="small-btn" aria-label="Fetch balance">Check Balance</button>
              <div class="muted" style="margin-left:auto;font-size:13px">Currency: <strong id="currencyLabel">BDT</strong></div>
            </div>
          </div>

          <div class="form-group">
            <label for="amount">Amount to Withdraw</label>
            <div class="input-wrapper">
              <span class="input-icon">üí∏</span>
              <input type="number" id="amount" name="amount" placeholder="Enter amount" min="1" step="0.01" inputmode="decimal" required>
            </div>
          </div>

          <div class="form-group">
            <label for="pin">Transaction PIN</label>
            <div class="input-wrapper">
              <span class="input-icon">üîê</span>
              <input type="password" id="pin" name="pin" placeholder="Enter your 4-digit PIN" maxlength="4" inputmode="numeric" pattern="\d{4}" autocomplete="current-password" required>
              <button type="button" class="pin-toggle" data-target="pin" aria-label="Show PIN">Show</button>
            </div>
            <div class="muted">Your 4-digit transaction PIN ‚Äî kept masked for security.</div>
          </div>
        </div>

        <div class="actions">
          <button type="submit" class="btn">Withdraw</button>
          <div class="muted" style="margin-left:auto">Need help? <a href="#contact">Contact support</a></div>
        </div>
      </form>
    </section>
  </main>

  <!-- Confirmation Modal -->
  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="modalTitle">
      <h3 id="modalTitle">Confirm Withdrawal</h3>
      <div class="row"><div class="muted">From Account</div><div id="mAccount">‚Äî</div></div>
      <div class="row"><div class="muted">Account Type</div><div id="mType">‚Äî</div></div>
      <div class="row"><div class="muted">Amount</div><div id="mAmount">‚Äî</div></div>
      <div class="row"><div class="muted">Available Balance</div><div id="mBalance">‚Äî</div></div>
      <div class="modal-actions">
        <button class="btn-ghost" id="modalCancel">Cancel</button>
        <button class="btn" id="modalConfirm">Confirm</button>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Demo balances ‚Äî replace with backend call
      const demoBalances = {
        "1001001": {balance: 5000.50, currency: 'BDT'},
        "1001002": {balance: 120.00, currency: 'BDT'},
        "2002001": {balance: 250000.75, currency: 'USD'}
      };

      const withdrawForm = document.getElementById('withdrawForm');
      const notify = document.getElementById('notify');
      const notifySuccess = document.getElementById('notifySuccess');
      const balanceBubble = document.getElementById('balanceBubble');
      const fetchBalanceBtn = document.getElementById('fetchBalanceBtn');
      const currencyLabel = document.getElementById('currencyLabel');

      const modalBackdrop = document.getElementById('modalBackdrop');
      const modalCancel = document.getElementById('modalCancel');
      const modalConfirm = document.getElementById('modalConfirm');

      // Modal fields
      const mAccount = document.getElementById('mAccount');
      const mType = document.getElementById('mType');
      const mAmount = document.getElementById('mAmount');
      const mBalance = document.getElementById('mBalance');

      let currentBalance = null;
      let currentCurrency = 'BDT';

      function showNotify(text){ notify.style.display = text ? 'block' : 'none'; notify.textContent = text || ''; notifySuccess.style.display='none'; }
      function showSuccess(text){ notifySuccess.style.display = text ? 'block' : 'none'; notifySuccess.textContent = text || ''; notify.style.display='none'; }

      // PIN toggle
      document.querySelectorAll('.pin-toggle').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const t = document.getElementById(btn.dataset.target);
          if(!t) return;
          if(t.type === 'password'){ t.type = 'text'; btn.textContent = 'Hide'; btn.setAttribute('aria-label','Hide PIN'); }
          else { t.type = 'password'; btn.textContent = 'Show'; btn.setAttribute('aria-label','Show PIN'); }
          t.focus();
        });
      });

      // Allow only digits in pin
      const pinInput = document.getElementById('pin');
      pinInput.addEventListener('input', ()=>{ pinInput.value = pinInput.value.replace(/[^0-9]/g,'').slice(0,4); });

      // Fetch balance (demo)
      fetchBalanceBtn.addEventListener('click', ()=>{
        const acct = document.getElementById('accountNum').value.trim();
        if(!acct){ showNotify('Enter account number to fetch balance.'); return; }
        const info = demoBalances[acct];
        if(info){
          currentBalance = Number(info.balance);
          currentCurrency = info.currency || 'BDT';
          balanceBubble.textContent = (currentBalance).toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2}) + ' ' + currentCurrency;
          currencyLabel.textContent = currentCurrency;
          showNotify('');
          showSuccess('Balance fetched.');
          setTimeout(()=> notifySuccess.style.display='none', 1500);
        } else {
          currentBalance = null;
          balanceBubble.textContent = '‚Äî';
          showNotify('No account found in demo data. Use a demo account like 1001001 or 1001002.');
        }
      });

      // Form submit -> validate and show confirmation modal
      withdrawForm.addEventListener('submit', (e)=>{
        e.preventDefault();
        showNotify('');
        showSuccess('');

        // basic HTML validity
        if(!withdrawForm.checkValidity()){
          showNotify('Please fill all required fields correctly.');
          withdrawForm.reportValidity();
          return;
        }

        const acct = document.getElementById('accountNum').value.trim();
        const type = document.getElementById('accountType').value;
        const amount = Number(document.getElementById('amount').value);
        const pin = document.getElementById('pin').value.trim();

        if(!acct){ showNotify('Account number is required.'); return; }
        if(!type){ showNotify('Select account type.'); return; }
        if(isNaN(amount) || amount <= 0){ showNotify('Enter a valid amount greater than 0.'); return; }
        if(!/^\d{4}$/.test(pin)){ showNotify('Enter your 4-digit transaction PIN.'); return; }

        // Check balance ‚Äî if not fetched, try to fetch from demo
        if(currentBalance === null){
          const demo = demoBalances[acct];
          if(demo){ currentBalance = Number(demo.balance); currentCurrency = demo.currency || 'BDT'; currencyLabel.textContent = currentCurrency; }
        }

        if(currentBalance === null){
          showNotify('Balance unknown. Click "Check Balance" or use a valid demo account (1001001).');
          return;
        }

        if(amount > currentBalance){
          showNotify('Insufficient balance. Cannot withdraw more than available balance.');
          return;
        }

        // All good ‚Äî show modal
        mAccount.textContent = acct;
        mType.textContent = type.charAt(0).toUpperCase() + type.slice(1);
        mAmount.textContent = amount.toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2}) + ' ' + currentCurrency;
        mBalance.textContent = currentBalance.toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2}) + ' ' + currentCurrency;

        openModal();
      });

      function openModal(){
        modalBackdrop.style.display = 'flex';
        modalBackdrop.setAttribute('aria-hidden','false');
        modalConfirm.focus();
      }
      function closeModal(){
        modalBackdrop.style.display = 'none';
        modalBackdrop.setAttribute('aria-hidden','true');
      }

      modalCancel.addEventListener('click', ()=> closeModal());

      // Confirm -> simulate transaction
      modalConfirm.addEventListener('click', ()=>{
        const acct = document.getElementById('accountNum').value.trim();
        const amount = Number(document.getElementById('amount').value);
        const pin = document.getElementById('pin').value.trim();

        // In real app: send fetch('/api/withdraw', {acct, amount, pin, ...})
        // Here: simulate success and update demoBalances if exists
        closeModal();

        // simulate processing
        modalConfirm.disabled = true;
        showNotify('');
        showSuccess('Processing transaction...');
        setTimeout(()=>{
          // deduct from demo if exists
          if(demoBalances[acct]){
            demoBalances[acct].balance = Number((demoBalances[acct].balance - amount).toFixed(2));
            currentBalance = demoBalances[acct].balance;
            balanceBubble.textContent = currentBalance.toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2}) + ' ' + demoBalances[acct].currency;
            currencyLabel.textContent = demoBalances[acct].currency || currentCurrency;
          } else {
            // if not in demo, just leave balance unknown
            currentBalance = null;
            balanceBubble.textContent = '‚Äî';
          }

          showSuccess('Withdrawal successful. Transaction ID: TX' + Date.now().toString().slice(-8));
          modalConfirm.disabled = false;
          // clear amount & pin for safety
          document.getElementById('amount').value = '';
          document.getElementById('pin').value = '';
          setTimeout(()=> notifySuccess.style.display='none', 5000);
        }, 900);
      });

      // close modal by clicking backdrop
      modalBackdrop.addEventListener('click', (ev)=>{
        if(ev.target === modalBackdrop) closeModal();
      });

      // keyboard: Escape closes modal
      window.addEventListener('keydown', (ev)=>{ if(ev.key === 'Escape' && modalBackdrop.style.display === 'flex') closeModal(); });

    })();
  </script>
</body>
</html>
